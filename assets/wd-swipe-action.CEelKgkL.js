import{r as e,e as a,T as l,w as t,K as u,o as s,M as o,d as i,g as n,h as c,k as r,i as v,n as d,p as f,l as p,R as h,q as m}from"./index-BHzFND5V.js";import{b as w,a as _,m as b,y as $}from"./wd-icon.EUjReaQE.js";import{_ as g}from"./_plugin-vue_export-helper.BCo6x5W8.js";let k=[];const V=g(a({name:"wd-swipe-action",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...w,modelValue:_("close"),disabled:b(!1),beforeClose:Function},emits:["click","update:modelValue"],setup(a,{expose:w,emit:_}){const b=a,g=_,V=l("__QUEUE_KEY__",null),y=e(""),C=e(0),x=e(0),M=e(!1),T=function(){const a=e(""),l=e(0),t=e(0),u=e(0),s=e(0),o=e(0),i=e(0);return{touchStart:function(e){const n=e.touches[0];a.value="",l.value=0,t.value=0,u.value=0,s.value=0,o.value=n.clientX,i.value=n.clientY},touchMove:function(e){const n=e.touches[0];l.value=n.clientX-o.value,t.value=n.clientY-i.value,u.value=Math.abs(l.value),s.value=Math.abs(t.value),a.value=u.value>s.value?"horizontal":u.value<s.value?"vertical":""},direction:a,deltaX:l,deltaY:t,offsetX:u,offsetY:s,startX:o,startY:i}}(),{proxy:X}=h();function Y(e,a){b.disabled||Q().then((([l,t])=>{switch(e){case"close":if(0===x.value)return;I("value",a);break;case"left":E(l);break;case"right":E(-t)}}))}function Q(){return Promise.all([$(".wd-swipe-action__left",!1,X).then((e=>e.width?e.width:0)),$(".wd-swipe-action__right",!1,X).then((e=>e.width?e.width:0))])}function E(e=0){const a=`translate3d(${e}px, 0, 0)`,l=M.value?"none":".6s cubic-bezier(0.18, 0.89, 0.32, 1)";y.value=`\n        -webkit-transform: ${a};\n        -webkit-transition: ${l};\n        transform: ${a};\n        transition: ${l};\n      `,x.value=e}function j(e){b.disabled||0===x.value||(I("click",e=e||"inside"),g("click",{value:e}))}function F(e){var a;b.disabled||(C.value=x.value,T.touchStart(e),V&&V.closeOther?V.closeOther(X):(a=X,k.forEach((e=>{e.$.uid!==a.$.uid&&e.$.exposed.close()}))))}function S(e){if(b.disabled)return;if(T.touchMove(e),"vertical"===T.direction.value)return;e.preventDefault(),e.stopPropagation(),M.value=!0;const a=C.value+T.deltaX.value;Q().then((([l,t])=>0===l&&a>0||0===t&&a<0?(E(0),F(e)):0!==l&&a>=l?(E(l),F(e)):0!==t&&-a>=t?(E(-t),F(e)):void E(a)))}function z(){if(b.disabled)return;const e=.3;M.value=!1,Q().then((([a,l])=>{C.value<0&&x.value<0&&x.value-C.value<l*e?(E(-l),g("update:modelValue","right")):C.value>0&&x.value>0&&C.value-x.value<a*e?(E(a),g("update:modelValue","left")):l>0&&C.value>=0&&x.value<0&&Math.abs(x.value)>l*e?(E(-l),g("update:modelValue","right")):a>0&&C.value<=0&&x.value>0&&Math.abs(x.value)>a*e?(E(a),g("update:modelValue","left")):I("swipe")}))}function I(e,a){if("swipe"===e&&0===C.value)return E(0);"swipe"===e&&C.value>0?a="left":"swipe"===e&&C.value<0&&(a="right"),e&&a&&b.beforeClose&&b.beforeClose(e,a),E(0),"close"!==b.modelValue&&g("update:modelValue","close")}return t((()=>b.modelValue),((e,a)=>{Y(e,a)}),{deep:!0}),u((()=>{var e;V&&V.pushToQueue?V.pushToQueue(X):(e=X,k.push(e)),C.value=0,x.value=0,M.value=!1})),s((()=>{M.value=!0,Y(b.modelValue),M.value=!1})),o((()=>{var e;V&&V.removeFromQueue?V.removeFromQueue(X):(e=X,k=k.filter((a=>a.$.uid!==e.$.uid)))})),w({close:I}),(e,a)=>{const l=m;return i(),n(l,{class:f(`wd-swipe-action ${e.customClass}`),style:d(e.customStyle),onClick:a[2]||(a[2]=p((e=>j()),["stop"])),onTouchstart:F,onTouchmove:S,onTouchend:z,onTouchcancel:z},{default:c((()=>[r(l,{class:"wd-swipe-action__wrapper",style:d(y.value)},{default:c((()=>[r(l,{class:"wd-swipe-action__left",onClick:a[0]||(a[0]=e=>j("left"))},{default:c((()=>[v(e.$slots,"left",{},void 0,!0)])),_:3}),v(e.$slots,"default",{},void 0,!0),r(l,{class:"wd-swipe-action__right",onClick:a[1]||(a[1]=e=>j("right"))},{default:c((()=>[v(e.$slots,"right",{},void 0,!0)])),_:3})])),_:3},8,["style"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-ec0f42c7"]]);export{V as _};
