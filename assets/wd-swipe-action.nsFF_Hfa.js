import{r as e,d as a,R as l,w as t,J as u,o as s,L as o,b as i,f as n,g as c,j as r,h as v,n as d,m as f,k as p,Q as h,p as m}from"./index-9AxPtOFn.js";import{b as w,a as _,m as b,y as $}from"./wd-icon.CAl56Gk6.js";import{_ as g}from"./_plugin-vue_export-helper.BCo6x5W8.js";let k=[];const V=g(a({name:"wd-swipe-action",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...w,modelValue:_("close"),disabled:b(!1),beforeClose:Function},emits:["click","update:modelValue"],setup(a,{expose:w,emit:_}){const b=a,g=_,V=l("__QUEUE_KEY__",null),y=e(""),C=e(0),x=e(0),M=e(!1),Q=function(){const a=e(""),l=e(0),t=e(0),u=e(0),s=e(0),o=e(0),i=e(0);return{touchStart:function(e){const n=e.touches[0];a.value="",l.value=0,t.value=0,u.value=0,s.value=0,o.value=n.clientX,i.value=n.clientY},touchMove:function(e){const n=e.touches[0];l.value=n.clientX-o.value,t.value=n.clientY-i.value,u.value=Math.abs(l.value),s.value=Math.abs(t.value),a.value=u.value>s.value?"horizontal":u.value<s.value?"vertical":""},direction:a,deltaX:l,deltaY:t,offsetX:u,offsetY:s,startX:o,startY:i}}(),{proxy:T}=h();function X(e,a){b.disabled||Y().then((([l,t])=>{switch(e){case"close":if(0===x.value)return;I("value",a);break;case"left":j(l);break;case"right":j(-t)}}))}function Y(){return Promise.all([$(".wd-swipe-action__left",!1,T).then((e=>e.width?e.width:0)),$(".wd-swipe-action__right",!1,T).then((e=>e.width?e.width:0))])}function j(e=0){const a=`translate3d(${e}px, 0, 0)`,l=M.value?"none":".6s cubic-bezier(0.18, 0.89, 0.32, 1)";y.value=`\n        -webkit-transform: ${a};\n        -webkit-transition: ${l};\n        transform: ${a};\n        transition: ${l};\n      `,x.value=e}function E(e){b.disabled||0===x.value||(I("click",e=e||"inside"),g("click",{value:e}))}function F(e){var a;b.disabled||(C.value=x.value,Q.touchStart(e),V&&V.closeOther?V.closeOther(T):(a=T,k.forEach((e=>{e.$.uid!==a.$.uid&&e.$.exposed.close()}))))}function S(e){if(b.disabled)return;if(Q.touchMove(e),"vertical"===Q.direction.value)return;e.preventDefault(),e.stopPropagation(),M.value=!0;const a=C.value+Q.deltaX.value;Y().then((([l,t])=>0===l&&a>0||0===t&&a<0?(j(0),F(e)):0!==l&&a>=l?(j(l),F(e)):0!==t&&-a>=t?(j(-t),F(e)):void j(a)))}function z(){if(b.disabled)return;const e=.3;M.value=!1,Y().then((([a,l])=>{C.value<0&&x.value<0&&x.value-C.value<l*e?(j(-l),g("update:modelValue","right")):C.value>0&&x.value>0&&C.value-x.value<a*e?(j(a),g("update:modelValue","left")):l>0&&C.value>=0&&x.value<0&&Math.abs(x.value)>l*e?(j(-l),g("update:modelValue","right")):a>0&&C.value<=0&&x.value>0&&Math.abs(x.value)>a*e?(j(a),g("update:modelValue","left")):I("swipe")}))}function I(e,a){if("swipe"===e&&0===C.value)return j(0);"swipe"===e&&C.value>0?a="left":"swipe"===e&&C.value<0&&(a="right"),e&&a&&b.beforeClose&&b.beforeClose(e,a),j(0),"close"!==b.modelValue&&g("update:modelValue","close")}return t((()=>b.modelValue),((e,a)=>{X(e,a)}),{deep:!0}),u((()=>{var e;V&&V.pushToQueue?V.pushToQueue(T):(e=T,k.push(e)),C.value=0,x.value=0,M.value=!1})),s((()=>{M.value=!0,X(b.modelValue),M.value=!1})),o((()=>{var e;V&&V.removeFromQueue?V.removeFromQueue(T):(e=T,k=k.filter((a=>a.$.uid!==e.$.uid)))})),w({close:I}),(e,a)=>{const l=m;return i(),n(l,{class:f(`wd-swipe-action ${e.customClass}`),style:d(e.customStyle),onClick:a[2]||(a[2]=p((e=>E()),["stop"])),onTouchstart:F,onTouchmove:S,onTouchend:z,onTouchcancel:z},{default:c((()=>[r(l,{class:"wd-swipe-action__wrapper",style:d(y.value)},{default:c((()=>[r(l,{class:"wd-swipe-action__left",onClick:a[0]||(a[0]=e=>E("left"))},{default:c((()=>[v(e.$slots,"left",{},void 0,!0)])),_:3}),v(e.$slots,"default",{},void 0,!0),r(l,{class:"wd-swipe-action__right",onClick:a[1]||(a[1]=e=>E("right"))},{default:c((()=>[v(e.$slots,"right",{},void 0,!0)])),_:3})])),_:3},8,["style"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-ec0f42c7"]]);export{V as _};
